(function(){var e={version:"0.0.1a",dev:!0};window.d3licia=e,e.utils={},e.models={},e.graphs=[],e.addGraph=function(t,n){e.graphs.push(t),e.render()},e.render=function(){_.each(e.graphs,function(e){e()})},window.onresize=function(t){e.render()},e.utils.merge_options=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},e.models.axis=function(t){var n={timestamp:!1,tickFormat:",.0f"},r=e.utils.merge_options(n,t);if(r.timestamp){var i=(r.scale.domain()[1]-r.scale.domain()[0])/r.ticks;if(r.timeFormat)var s=d3.time.format(r.timeFormat);else switch(!0){case i<6e4:var s=d3.time.format("%Hh%Mm%S");break;case i<864e5:var s=d3.time.format("%Hh%M");break;case i<26784e5:var s=d3.time.format("%e / %m");case i<321408e5:var s=d3.time.format("%m / %Y");break;default:var s=d3.time.format("%Y")}var o=function(e){return s(new Date(e))}}else var o=d3.format(r.tickFormat);var u=d3.svg.axis().scale(r.scale).orient(r.orient).ticks(r.ticks).tickFormat(o);return u},e.models.line=function(t,n){var r={selector:"#graph",margin:0},i=e.utils.merge_options(r,n)},e.models.chart=function(t,n){var r={selector:"#graph",margin:20,timestamp:!1,xticks:10,yticks:10},i=e.utils.merge_options(r,n);i.width=parseInt(d3.select(n.selector).style("width")),i.height=parseInt(d3.select(n.selector).style("height")),i.w=i.width-2*i.margin,i.h=i.height-2*i.margin,d3.select(i.selector).html("");var s=null,o=null;_.each(t,function(e){var t=d3.min(e.values,function(e){return e.x}),n=d3.max(e.values,function(e){return e.x});o=o===null||o>t?t:o,s=s===null||s<n?n:s});var u=null,a=null;_.each(t,function(e){var t=d3.min(e.values,function(e){return e.y}),n=d3.max(e.values,function(e){return e.y});a=a===null||a>t?t:a,u=a===null||u<n?n:u});var f=d3.scale.linear().domain([o,s]).range([0,i.w]),l=d3.scale.linear().domain([a,u]).range([i.h,0]),c=e.models.axis({scale:f,timestamp:i.timestamp,orient:"bottom",ticks:i.xticks,timeFormat:i.timeFormat!==undefined?i.timeFormat:null}),h=e.models.axis({scale:l,orient:"left",ticks:i.yticks}),p=d3.select(i.selector).append("svg:svg").attr("width",i.width).attr("height",i.height).append("svg:g").attr("transform","translate("+i.margin+","+i.margin+")");p.append("g").attr("class","axis").attr("transform","translate(0, "+i.h+")").call(c),p.append("g").attr("class","axis").call(h),_.each(t,function(e){switch(e.type){case"bar":break;case"line":var t=d3.svg.line().x(function(e){return f(e.x)}).y(function(e){return l(e.y)}).interpolate(e.interpolation!==undefined?e.interpolation:"linear");p.selectAll(".chart").data([e.values]).enter().append("svg:path").attr("d",t).attr("fill","none").attr("stroke-width","2").attr("stroke",e.color)}})}})();